Object subclass: #Baraja	instanceVariableNames: 'cartas numeroMasos'	classVariableNames: ''	poolDictionaries: ''	category: 'juego'!!Baraja methodsFor: 'getters' stamp: 'agb 2/6/2011 02:11'!cartas^cartas! !!Baraja methodsFor: 'getters' stamp: 'agb 2/7/2011 01:31'!numCartas^cartas size! !!Baraja methodsFor: 'getters' stamp: 'agb 2/7/2011 01:00'!numeroMasos^numeroMasos! !!Baraja methodsFor: 'as yet unclassified' stamp: 'agb 2/7/2011 01:25'!barajar|pos n carta|n := cartas size.1to: n do:[:i|		pos := n atRandom.		carta := (cartas removeFirst).		cartas add:carta afterIndex:pos-1. 	]! !!Baraja methodsFor: 'as yet unclassified' stamp: 'agb 2/7/2011 01:31'!getCarta|carta|carta :=cartas removeFirst.(cartas size)==10 ifTrue:[self barajar].^carta! !!Baraja methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 03:58'!llenarMasos|letra nombres carta palo valores|letra _#('s' 'h' 'd' 'c').palo _#('CORAZON NEGRO' 'CORAZON ROJO' 'BRILLO' 'TREBOL').cartas _OrderedCollection new.nombres _#('AS','Dos','Tres','Cuatro','Cinco','Seis','Siete','Ocho','Nueve','Diez','J','Q','K').valores _#(11 2 3 4 5 6 7 8 9 10 10 10 10).numeroMasos timesRepeat:[	1to:4do:[:i|		1to:13do:[:j|				carta :=Carta new.				carta palo:(palo at:i).				carta nombre: (nombres at:j).				carta imagen: (j asString,(letra at:i) asString,'.gif').				carta valor:(valores at:j).				cartas add:carta.			]		].	].self barajar.! !!Baraja methodsFor: 'setters' stamp: 'agb 2/7/2011 01:00'!numeroMasos:aNumbernumeroMasos_ aNumber! !ScriptableButton subclass: #Boton	instanceVariableNames: 'enabled'	classVariableNames: ''	poolDictionaries: ''	category: 'juego'!!Boton methodsFor: 'as yet unclassified' stamp: 'agb 2/7/2011 23:54'!enabled^enabled! !!Boton methodsFor: 'as yet unclassified' stamp: 'agb 2/8/2011 13:05'!enabled:aBoolean|elemento|elemento := (self submorphs)first.enabled_ aBoolean.aBoolean = true ifTrue:[		self color:(Color r: 0.94 g: 0.94 b: 0.944).		elemento color:(Color r: 0 g: 0 b: 0).	]ifFalse:[		self color:(Color r: 0.878 g: 0.878 b: 0.882).		elemento color:(Color r: 0.721 g: 0.721 b: 0.725).	].! !!Boton methodsFor: 'as yet unclassified' stamp: 'agb 2/8/2011 11:47'!initializeenabled_ true.super initialize.self color:(Color r: 0.94 g: 0.94 b: 0.944).! !!Boton methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 04:15'!text^self submorphs first! !!Boton methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 04:07'!text:aString|elemento|elemento := (self submorphs)first.elemento delete.elemento := StringMorph new.elemento contents:aString.self addMorphCentered:elemento.! !Object subclass: #Carta	instanceVariableNames: 'palo nombre valor imagen'	classVariableNames: ''	poolDictionaries: ''	category: 'juego'!!Carta methodsFor: 'getters' stamp: 'agb 2/6/2011 01:25'!imagen^imagen! !!Carta methodsFor: 'getters' stamp: 'agb 2/6/2011 01:22'!nombre ^ nombre! !!Carta methodsFor: 'getters' stamp: 'agb 2/6/2011 01:16'!palo ^ palo! !!Carta methodsFor: 'getters' stamp: 'agb 2/6/2011 01:24'!valor^valor! !!Carta methodsFor: 'setters' stamp: 'agb 2/6/2011 01:25'!imagen: aString imagen _ aString! !!Carta methodsFor: 'setters' stamp: 'agb 2/6/2011 01:22'!nombre:aStringnombre _aString! !!Carta methodsFor: 'setters' stamp: 'agb 2/6/2011 01:17'!palo: aString palo _ aString! !!Carta methodsFor: 'setters' stamp: 'agb 2/6/2011 01:24'!valor: aNumber valor _ aNumber! !RectangleMorph subclass: #ComboBox	instanceVariableNames: 'value elementos menu mostrar morphtexto index valores'	classVariableNames: ''	poolDictionaries: ''	category: 'juego'!!ComboBox methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 01:17'!addItem:aStringelementos add:aString.! !!ComboBox methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 02:22'!addItem:aString value:aObjectelementos add:aString.valores add:aObject.! !!ComboBox methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 01:42'!clickActionself text:'click'.! !!ComboBox methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 02:23'!initialize|boton|super initialize.elementos_ OrderedCollection new.valores_ OrderedCollection new.mostrar_ false.self extent:200@25.self borderWidth:1.self color:(Color r:1 g:1 b:1).morphtexto:= StringMorph new.morphtexto contents:'Eliga una opcion'.self addMorphCentered:morphtexto.boton:= RectangleMorph new.boton extent:25@25.boton borderWidth:0.boton position:(self position)+(self extent) - (0@25).boton color:(Color r:0 g:0 b:0).self addMorph:boton.self openInWorld.self on: #click send: #value to:[			self mostrarElementos.		].! !!ComboBox methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 12:29'!mostrarElementos|pinicial|mostrar ifTrue:[^nil].elementos size < 1 ifTrue:[^nil].pinicial:= self position + (0@(self height)).menu:= RectangleMorph new.menu extent:225@((25*(elementos size))+1).menu position:pinicial.pinicial:=pinicial+(1@0).1 to:(elementos size) do:[:i|		|elemento|		elemento:= Boton new.		elemento position:pinicial.		elemento borderWidth:0.		elemento extent:223@25.		pinicial := pinicial + (0@(self height)).		elemento text:(elementos at:i).		elemento on: #click send: #value to:[			self text:(elementos at:i).			index:=i.			mostrar := false.			menu delete.		].		menu addMorph:elemento.	].self addMorph: menu.menu borderWidth:1.mostrar:=true.! !!ComboBox methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 03:52'!selectedIndex:aIndexmorphtexto delete.morphtexto := StringMorph new.morphtexto contents:(elementos at:aIndex).index:= aIndex.self addMorphCentered:morphtexto.! !!ComboBox methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 02:22'!text^elementos at:index.! !!ComboBox methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 02:12'!text:aStringmorphtexto delete.morphtexto := StringMorph new.morphtexto contents:aString.self addMorphCentered:morphtexto.! !!ComboBox methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 02:22'!value^valores at:index.! !SystemWindow subclass: #Inicial	instanceVariableNames: 'ltipo baceptar cmasos ctipo lmasos game'	classVariableNames: ''	poolDictionaries: ''	category: 'juego'!!Inicial methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 03:57'!initializesuper initialize.self setLabel:'Valores Iniciales'.ltipo:= StringMorph new.ltipo contents: 'Tipo Jugador:'.ltipo position:(self position)+(20@40).self addMorph:ltipo.lmasos:= StringMorph new.lmasos contents: 'N Masos:'.lmasos position:(self position)+(40@80).self addMorph:lmasos."boton acpetar"baceptar:= Boton new.baceptar text:'Aceptar'.baceptar extent:70@30.baceptar position:(self position)+(275@115).self addMorph: baceptar."combo masos"cmasos_ ComboBox new.cmasos addItem:'uno' value:1.cmasos addItem:'dos' value:2.cmasos addItem:'tres' value:3.cmasos selectedIndex:1.cmasos position: (self position)+(120@75).self addMorph: cmasos."combo tipo jugador"ctipo_ ComboBox new.ctipo addItem:'Humano' value:'HUMANO'.ctipo addItem:'Temperamental' value:'TEMPERAMENTAL'.ctipo addItem:'Conservador' value:'CONSERVADOR'.ctipo selectedIndex:1.ctipo position: (self position)+(120@35).self addMorph: ctipo.super extent: 370@160.super color:(Color r: 0.91 g: 0.932 b: 0.938)."eventos"baceptar on: #click send: #value to:[		|jugador baraja|		jugador:= game jugador.		baraja:= game baraja.		jugador tipo:(ctipo value).		baraja numeroMasos:(cmasos value).		baraja llenarMasos.		game mostrarComponentes.		self delete.	].! !!Inicial methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 03:29'!juego:aJuegogame:=aJuego.! !RectangleMorph subclass: #Juego	instanceVariableNames: 'baraja jugador dealer canvas bnuevo bsalir bpedir brepartir bparar pcartasjugador pcartasdealer resultado totaldealer totaljugador fondo cartavirada lbaraja apuesta lapuesta lfondo lmanodealer lmanojugador barraestado menu btipo'	classVariableNames: ''	poolDictionaries: ''	category: 'juego'!!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/7/2011 05:31'!actualizarBarraBaraja	lbaraja contents: 'Cartas Baraja: ', (baraja numCartas) asString.! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/7/2011 05:30'!actualizarBarraDealer	totaldealer contents: 'Posible total dealer: ', (dealer sumarMano) asString.! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/8/2011 11:08'!actualizarBarraJugador totaljugador contents: 'Posible total Jugador: ', (jugador sumarMano) asString.! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/8/2011 02:11'!apuestaCorrecta(self valorApuesta <= jugador monto)ifTrue:[^true].resultado contents:'No tienes para apostar eso.!!'.^false.! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 03:30'!baraja^baraja! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/8/2011 01:19'!deshabilitarBotones	brepartir enabled:false.	bpedir enabled:false.	bparar enabled:false.! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 03:43'!estadoInicialbpedir visible:false.bparar visible:false.brepartir visible:false.lapuesta visible:false.fondo visible:false.apuesta visible:false.lfondo visible:false.resultado visible:false.lmanodealer visible:false.lmanojugador visible:false.pcartasjugador visible:false.pcartasdealer visible:false.totaldealer contents:''.totaljugador contents:''.lbaraja contents:''.pcartasjugador removeAllMorphs.pcartasdealer removeAllMorphs.! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/8/2011 01:17'!habilitarHumano	brepartir enabled:false.	bpedir enabled:true.	bparar enabled:true.! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/8/2011 01:17'!habilitarNoHumano	brepartir enabled:true.	bpedir enabled:false.	bparar enabled:false.! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/8/2011 11:51'!iniciarRonda|carta|resultado contents:''.fondo contents: (jugador monto) asString.carta := baraja getCarta.cartavirada:= ImageMorph new.cartavirada image: (ImageReadWriter formFromFileNamed: 'cards\baraja.gif').pcartasdealer addMorphCentered:cartavirada.dealer addCartaMano:carta.carta := baraja getCarta.dealer addCartaMano:carta.dealer agregarCartaPanel:carta panel:pcartasdealer.totaldealer contents:'Posible total dealer:??'.carta := baraja getCarta.jugador addCartaMano:carta.jugador agregarCartaPanel:carta panel:pcartasjugador.carta := baraja getCarta.jugador addCartaMano:carta.jugador agregarCartaPanel:carta panel:pcartasjugador.self actualizarBarraJugador.self actualizarBarraBaraja.jugador tieneVeintiuna ifTrue:[		self turnoDealer.		self habilitarNoHumano.		^nil.	].jugador tipo ~= 'HUMANO' ifTrue:[		self habilitarNoHumano.		self turnoJugador.		self turnoDealer.	]ifFalse:[		self habilitarHumano.	].! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 12:15'!initialize|ventana|super initialize.jugador_ Jugador new.jugador tipo:'HUMANO'.dealer_ Dealer new.baraja_ Baraja new."creacion del canvas"canvas:=self.self width:670.self height:580.self color:(Color r: 0.004 g: 0.498 b: 0.004).self  borderWidth:1.self openInWorld."boton pedir"bpedir:=Boton new.bpedir width:138.bpedir height:68.bpedir text:'Pedir'.canvas addMorph: bpedir.bpedir position:(canvas position)+(110@450)."boton parar"bparar:=Boton new.bparar width:138.bparar height:68.bparar text:'Parar'.canvas addMorph: bparar.bparar position:(canvas position)+(268@450)."boton repartir"brepartir:=Boton new.brepartir width:138.brepartir height:68.brepartir text:'Repartir'.canvas addMorph: brepartir.brepartir position:(canvas position)+(426@450)."panel cartas jugador"pcartasjugador:=RectangleMorph new.pcartasjugador width:573.pcartasjugador height:167.pcartasjugador color:(Color transparent).pcartasjugador position:(canvas position)+(45@258).pcartasjugador borderWidth:0.canvas addMorph:pcartasjugador."panel cartas dealer"pcartasdealer:=RectangleMorph new.pcartasdealer width:573.pcartasdealer height:167.pcartasdealer borderWidth:0.pcartasdealer color:(Color transparent).pcartasdealer position:(canvas position)+(45@48).canvas addMorph:pcartasdealer."resultado"resultado:=StringMorph new.resultado position:(canvas position)+(305@225).resultado color:(Color r: 1.0 g: 1.0 b: 1.0).canvas addMorph:resultado."apuesta"apuesta:= TextMorph new.apuesta contents: '10'.apuesta position:(canvas position)+(335@425).apuesta backgroundColor:(Color r:1 g:1 b:1).apuesta borderWidth:1.canvas addMorph:apuesta."fondo"fondo:=StringMorph new.fondo position:(canvas position)+(335@405).fondo contents:'fondo'.canvas addMorph:fondo."labels lapuesta lfondo lmanodealer lmanojugador"lapuesta:= StringMorph new.lapuesta position:(canvas position)+(270@425).lapuesta color:(Color r:1 g:1 b:1).lapuesta contents:'Apuesta:'.canvas addMorph:lapuesta.lmanodealer:= StringMorph new.lmanodealer position:(canvas position)+(180@60).lmanodealer color:(Color r:1 g:1 b:1).lmanodealer contents:'Mano Dealer:'.canvas addMorph:lmanodealer.lmanojugador:= StringMorph new.lmanojugador position:(canvas position)+(180@269).lmanojugador color:(Color r:1 g:1 b:1).lmanojugador contents:'Mano Jugador:'.canvas addMorph:lmanojugador.lfondo := StringMorph new.lfondo position:(canvas position)+(270@405).lfondo color:(Color r:1 g:1 b:1).lfondo contents:'Fondos:'.canvas addMorph:lfondo."barra estado"barraestado := RectangleMorph new.barraestado width:canvas width - 2.barraestado height:20.barraestado position:(canvas position)+(1@(canvas height - 21)).barraestado borderWidth:0.barraestado color:(Color r: 0.878 g: 0.878 b: 0.882).canvas addMorph:barraestado."mensajes dealer"totaldealer:=StringMorph new.totaldealer position:(barraestado position)+(455@4).barraestado addMorph:totaldealer."mensajes jugador"totaljugador:=StringMorph new.totaljugador position:(barraestado position)+(235@4).barraestado addMorph:totaljugador."mensajes baraja"lbaraja:=StringMorph new.lbaraja position:(barraestado position)+(50@4).barraestado addMorph:lbaraja."menu"menu := RectangleMorph new.menu width:canvas width - 2.menu height:20.menu position:(canvas position)+(1@1).menu borderWidth:0.menu color:(Color r: 0.784 g: 0.784 b: 0.788).canvas addMorph:menu."boton Nuevo"bnuevo:=Boton new.bnuevo width:138.bnuevo height:20.bnuevo text:'Nuevo'.bnuevo borderWidth:0.menu addMorph: bnuevo.bnuevo position:(menu position)."boton tipo"btipo:=Boton new.btipo width:138.btipo height:20.btipo text:'Camb. Tipo'.btipo borderWidth:0.menu addMorph: btipo.btipo position:(menu position)+(140@0)."boton salir"bsalir:=Boton new.bsalir extent:20@20.bsalir text:'X'."(bsalir text)color:(Color r:1 g:1 b:1).bsalir color:(Color r: 0.972 g: 0.439 b: 0.662)."bsalir borderWidth:0.menu addMorph: bsalir.bsalir position:(menu position+((menu width - 20)@0))."eventos"bpedir on: #click send: #value to:[		bpedir enabled ifTrue:[			jugador tipo ~= 'HUMANO' ifTrue:[				self habilitarNoHumano.				self turnoJugador.				self turnoDealer.			]			ifFalse:[(self apuestaCorrecta)ifTrue:[self turnoJugador].			].].	].bsalir on: #click send: #value to:[	  self delete.  	].btipo on: #click send: #value to:[	  	|vent|		vent:=TipoJugador new.		vent jugador:jugador.		vent position:(self position)+(150@150).		self addMorph:vent.	].bnuevo on: #click send: #value to:[		|vent|		self estadoInicial.		vent:= Inicial new.		vent juego:self.		vent position:(self position)+(150@150).		self addMorph:vent.	].brepartir on: #click send: #value to:[	brepartir enabled ifTrue:[		(self apuestaCorrecta & (baraja numCartas > 3))ifTrue:[				pcartasjugador removeAllMorphs.				pcartasdealer removeAllMorphs.				jugador vaciarMano.				dealer vaciarMano.				self iniciarRonda.			].		].	].bparar on: #click send: #value to:[	bparar enabled ifTrue:[			(self apuestaCorrecta)ifTrue:[self turnoDealer].		].	].self estadoInicial.ventana:= Inicial new.ventana juego:self.ventana position:(self position)+(150@150).self addMorph:ventana.! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 03:29'!jugador^jugador! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 03:21'!mostrarComponentesbpedir visible:true.bparar visible:true.brepartir visible:true.lapuesta visible:true.fondo visible:true.apuesta visible:true.lfondo visible:true.resultado visible:true.lmanodealer visible:true.lmanojugador visible:true.pcartasjugador visible:true.pcartasdealer visible:true.jugador vaciarMano.dealer vaciarMano.jugador monto:100.apuesta contents:10 asString.self iniciarRonda.! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/8/2011 12:03'!turnoDealer	|manodealer manojugador jugadorTieneVeintiuna|	self habilitarNoHumano.	cartavirada image: (ImageReadWriter formFromFileNamed: 'cards\', (dealer getPrimeraCarta)imagen).	manodealer := dealer sumarMano.	manojugador := jugador sumarMano.	jugadorTieneVeintiuna := jugador tieneVeintiuna.	(manojugador < 22 & (jugadorTieneVeintiuna = false) & (dealer tieneVeintiuna = false)) ifTrue:[			dealer jugar: baraja panel: pcartasdealer.			].	manodealer := dealer sumarMano.	(((manodealer > 21) | (manodealer < manojugador)) & (manojugador < 22)) ifTrue:[			|valor|			valor := self valorApuesta.			jugadorTieneVeintiuna ifTrue:[valor := valor * 1.5].			jugador monto:(jugador monto)+valor.			resultado contents:'GANASTE'.		]	ifFalse:[			(manojugador~=manodealer)			ifTrue:[					jugador monto:(jugador monto)-self valorApuesta.					resultado contents:'PERDISTE'.				]			ifFalse:[ resultado contents:'EMPATE'].		].	fondo contents:(jugador monto)asString.	(jugador monto <2) ifTrue:[			resultado contents:'Te has quedado sin dinero.!!'.			self deshabilitarBotones.		].	(baraja numCartas < 4) ifTrue:[			resultado contents:'Te llevas $',(jugador monto) asString.			self deshabilitarBotones.		].	self actualizarBarraDealer.	self actualizarBarraBaraja.! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/8/2011 02:05'!turnoJugadorjugador jugar:baraja panel:pcartasjugador.jugador sumarMano > 20 ifTrue:[self turnoDealer].self actualizarBarraBaraja.self actualizarBarraJugador.(baraja numCartas < 1) ifTrue:[self turnoDealer].! !!Juego methodsFor: 'as yet unclassified' stamp: 'agb 2/8/2011 02:10'!valorApuesta^((apuesta text) asNumber)! !Object subclass: #Jugador	instanceVariableNames: 'tipo nombre monto mano'	classVariableNames: ''	poolDictionaries: ''	category: 'juego'!!Jugador methodsFor: 'setters' stamp: 'agb 2/6/2011 15:03'!mano:aOrderedCollectionmano _aOrderedCollection! !!Jugador methodsFor: 'setters' stamp: 'agb 2/6/2011 15:02'!monto:aNumbermonto _aNumber! !!Jugador methodsFor: 'setters' stamp: 'agb 2/6/2011 15:02'!nombre:aStringnombre _aString! !!Jugador methodsFor: 'setters' stamp: 'agb 2/6/2011 15:01'!tipo:aStringtipo _aString! !!Jugador methodsFor: 'getters' stamp: 'agb 2/6/2011 15:00'!mano^mano! !!Jugador methodsFor: 'getters' stamp: 'agb 2/6/2011 15:01'!monto^monto! !!Jugador methodsFor: 'getters' stamp: 'agb 2/6/2011 15:01'!nombre^nombre! !!Jugador methodsFor: 'getters' stamp: 'agb 2/6/2011 15:01'!tipo^tipo! !!Jugador methodsFor: 'as yet unclassified' stamp: 'agb 2/6/2011 21:34'!addCartaMano:aCartamano add:aCarta.! !!Jugador methodsFor: 'as yet unclassified' stamp: 'agb 2/7/2011 03:25'!agregarCartaPanel: carta panel: panel|imagen panelalto panelancho cartas ncartas ppanel pinicial temp|imagen:= ImageMorph new.imagen image: (ImageReadWriter formFromFileNamed: 'cards\', carta imagen).cartas:=panel submorphs.ncartas:=cartas size +1.panelalto:=panel height/2.panelancho:=panel width/2.ppanel:=panel position.pinicial:=ppanel +(panelancho @ panelalto) - ((imagen width/2)*ncartas @ (imagen height/2)).1to: (ncartas-1) do:[:i|		temp:=cartas at:i.		temp position: pinicial.		pinicial:=pinicial + (78@0).	].imagen position:pinicial.panel addMorph: imagen."73 97"! !!Jugador methodsFor: 'as yet unclassified' stamp: 'agb 2/7/2011 03:42'!getNumeroCartas^ mano size! !!Jugador methodsFor: 'as yet unclassified' stamp: 'agb 2/7/2011 05:38'!getPrimeraCarta ^ mano first.! !!Jugador methodsFor: 'as yet unclassified' stamp: 'agb 2/7/2011 23:12'!initializemano _ OrderedCollection new.monto_ 100.! !!Jugador methodsFor: 'as yet unclassified' stamp: 'agb 2/7/2011 03:40'!jugar:baraja panel:panel|carta|(baraja numCartas) < 1 ifTrue:[^nil].tipo = 'HUMANO' ifTrue:[		carta := baraja getCarta.		self addCartaMano:carta.		self agregarCartaPanel: carta panel:panel.	].tipo = 'TEMPERAMENTAL' ifTrue:[		|posi|		posi := 100 atRandom.		posi < 76 ifTrue:[				[self sumarMano < 17]whileTrue:[					carta := baraja getCarta.					self addCartaMano:carta.					self agregarCartaPanel: carta panel:panel.				].			].			].tipo = 'CONSERVADOR' ifTrue:[		[self sumarMano < 15]whileTrue:[			carta := baraja getCarta.			self addCartaMano:carta.			self agregarCartaPanel: carta panel:panel.		].	].! !!Jugador methodsFor: 'as yet unclassified' stamp: 'agb 2/8/2011 11:55'!sumarMano|total numas n carta|total:=0.numas:=0.n:= mano size.1to: n do:[:i|			carta := mano at:i.			total := total + carta valor.			(carta valor) = 11 ifTrue:[numas:=numas+1].		].	[(total >21) & (numas>0)] whileTrue:[		total :=total-10.		numas := numas-1.	].^total! !!Jugador methodsFor: 'as yet unclassified' stamp: 'agb 2/7/2011 03:43'!tieneVeintiuna	^(self getNumeroCartas = 2) & (self sumarMano =21)! !!Jugador methodsFor: 'as yet unclassified' stamp: 'agb 2/8/2011 02:32'!vaciarMano[mano size >0] whileTrue:[mano removeFirst].! !Jugador subclass: #Dealer	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'juego'!!Dealer methodsFor: 'as yet unclassified' stamp: 'agb 2/7/2011 23:13'!initializeself tipo: 'DEALER'.mano _ OrderedCollection new.monto_ 100.! !!Dealer methodsFor: 'as yet unclassified' stamp: 'agb 2/7/2011 03:53'!jugar:baraja panel:panel|carta|(baraja numCartas) < 1 ifTrue:[^nil].[self sumarMano < 17]whileTrue:[	carta := baraja getCarta.	self addCartaMano:carta.	self agregarCartaPanel: carta panel:panel.].	! !SystemWindow subclass: #TipoJugador	instanceVariableNames: 'lactual lcambiar actual ctipo baceptar jugador'	classVariableNames: ''	poolDictionaries: ''	category: 'juego'!!TipoJugador methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 11:39'!initializesuper initialize.self setLabel:'Valores Iniciales'.lactual:= StringMorph new.lactual contents: 'Tipo actual:'.lactual position:(self position)+(20@40).self addMorph:lactual.lcambiar:= StringMorph new.lcambiar contents: 'Cambiar a:'.lcambiar position:(self position)+(40@80).self addMorph:lcambiar."boton acpetar"baceptar:= Boton new.baceptar text:'Aceptar'.baceptar extent:70@30.baceptar position:(self position)+(275@115).self addMorph: baceptar."combo masos"actual:= StringMorph new.actual contents:''.actual position: (self position)+(125@40).self addMorph: actual."combo tipo jugador"ctipo_ ComboBox new.ctipo addItem:'Humano' value:'HUMANO'.ctipo addItem:'Temperamental' value:'TEMPERAMENTAL'.ctipo addItem:'Conservador' value:'CONSERVADOR'.ctipo selectedIndex:1.ctipo position: (self position)+(120@75).self addMorph: ctipo."eventos"baceptar on: #click send: #value to:[		jugador tipo:(ctipo value).		self delete.	].super extent: 370@160.super color:(Color r: 0.91 g: 0.932 b: 0.938).! !!TipoJugador methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 05:13'!jugador:ajugadorjugador_ ajugador.self tipoActual:jugador tipo.! !!TipoJugador methodsFor: 'as yet unclassified' stamp: 'agb 2/9/2011 11:39'!tipoActual:aStringactual contents: aString! !